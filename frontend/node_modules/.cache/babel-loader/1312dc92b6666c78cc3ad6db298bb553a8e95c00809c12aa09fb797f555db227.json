{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\tommy\\\\codes\\\\Sistema-Gestao-Web\\\\frontend\\\\src\\\\pages\\\\Venda.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport api from '../services/api';\nimport './Venda.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Venda() {\n  _s();\n  const [clientes, setClientes] = useState([]);\n  const [produtos, setProdutos] = useState([]);\n  const [clienteId, setClienteId] = useState('');\n  const [itens, setItens] = useState([{\n    produto_id: '',\n    quantidade: 1,\n    preco_unitario: 0\n  }]);\n  const [valorTotal, setValorTotal] = useState(0);\n  useEffect(() => {\n    const token = localStorage.getItem('token');\n    api.get('/clientes', {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(res => setClientes(res.data));\n    api.get('/produtos', {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }).then(res => setProdutos(res.data));\n  }, []);\n  useEffect(() => {\n    const total = itens.reduce((acc, item) => acc + item.quantidade * item.preco_unitario, 0);\n    setValorTotal(total);\n  }, [itens]);\n  const handleItemChange = (index, field, value) => {\n    const novosItens = [...itens];\n    novosItens[index][field] = field === 'quantidade' || field === 'preco_unitario' ? Number(value) : value;\n    setItens(novosItens);\n  };\n  const adicionarItem = () => {\n    setItens([...itens, {\n      produto_id: '',\n      quantidade: 1,\n      preco_unitario: 0\n    }]);\n  };\n  const removerItem = index => {\n    const novosItens = itens.filter((_, i) => i !== index);\n    setItens(novosItens);\n  };\n  const finalizarVenda = async () => {\n    const token = localStorage.getItem('token');\n    try {\n      const payload = {\n        cliente_id: clienteId || null,\n        itens\n      };\n      const res = await api.post('/vendas', payload, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      alert(`✅ Venda registrada! ID: ${res.data.venda_id}`);\n      setClienteId('');\n      setItens([{\n        produto_id: '',\n        quantidade: 1,\n        preco_unitario: 0\n      }]);\n    } catch (err) {\n      console.error(err);\n      alert('❌ Erro ao registrar venda');\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"venda-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83D\\uDED2 Registrar Venda\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n      value: clienteId,\n      onChange: e => setClienteId(e.target.value),\n      children: [/*#__PURE__*/_jsxDEV(\"option\", {\n        value: \"\",\n        children: \"Cliente (opcional)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 9\n      }, this), clientes.map(c => /*#__PURE__*/_jsxDEV(\"option\", {\n        value: c.id,\n        children: c.nome\n      }, c.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this), itens.map((item, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"item-venda\",\n      children: [/*#__PURE__*/_jsxDEV(\"select\", {\n        value: item.produto_id,\n        onChange: e => handleItemChange(index, 'produto_id', e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Produto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 13\n        }, this), produtos.map(p => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: p.id,\n          children: p.nome\n        }, p.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        placeholder: \"Qtd\",\n        value: item.quantidade,\n        onChange: e => handleItemChange(index, 'quantidade', e.target.value),\n        min: 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"number\",\n        placeholder: \"Pre\\xE7o unit\\xE1rio\",\n        value: item.preco_unitario,\n        onChange: e => handleItemChange(index, 'preco_unitario', e.target.value),\n        min: 0,\n        step: \"0.01\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => removerItem(index),\n        children: \"\\uD83D\\uDDD1\\uFE0F\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }, this)]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }, this)), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: adicionarItem,\n      children: \"\\u2795 Adicionar Produto\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: [\"Total: R$ \", valorTotal.toFixed(2)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"finalizar-btn\",\n      onClick: finalizarVenda,\n      children: \"\\uD83D\\uDCBE Finalizar Venda\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 60,\n    columnNumber: 5\n  }, this);\n}\n_s(Venda, \"dppYILO2K4KFIXRzuktafFfsAPc=\");\n_c = Venda;\nexport default Venda;\nvar _c;\n$RefreshReg$(_c, \"Venda\");","map":{"version":3,"names":["React","useState","useEffect","api","jsxDEV","_jsxDEV","Venda","_s","clientes","setClientes","produtos","setProdutos","clienteId","setClienteId","itens","setItens","produto_id","quantidade","preco_unitario","valorTotal","setValorTotal","token","localStorage","getItem","get","headers","Authorization","then","res","data","total","reduce","acc","item","handleItemChange","index","field","value","novosItens","Number","adicionarItem","removerItem","filter","_","i","finalizarVenda","payload","cliente_id","post","alert","venda_id","err","console","error","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onChange","e","target","map","c","id","nome","p","type","placeholder","min","step","onClick","toFixed","_c","$RefreshReg$"],"sources":["C:/Users/tommy/codes/Sistema-Gestao-Web/frontend/src/pages/Venda.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport api from '../services/api';\r\nimport './Venda.css';\r\n\r\nfunction Venda() {\r\n  const [clientes, setClientes] = useState([]);\r\n  const [produtos, setProdutos] = useState([]);\r\n  const [clienteId, setClienteId] = useState('');\r\n  const [itens, setItens] = useState([{ produto_id: '', quantidade: 1, preco_unitario: 0 }]);\r\n  const [valorTotal, setValorTotal] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const token = localStorage.getItem('token');\r\n    api.get('/clientes', { headers: { Authorization: `Bearer ${token}` } })\r\n      .then(res => setClientes(res.data));\r\n    api.get('/produtos', { headers: { Authorization: `Bearer ${token}` } })\r\n      .then(res => setProdutos(res.data));\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const total = itens.reduce((acc, item) => acc + item.quantidade * item.preco_unitario, 0);\r\n    setValorTotal(total);\r\n  }, [itens]);\r\n\r\n  const handleItemChange = (index, field, value) => {\r\n    const novosItens = [...itens];\r\n    novosItens[index][field] = field === 'quantidade' || field === 'preco_unitario' ? Number(value) : value;\r\n    setItens(novosItens);\r\n  };\r\n\r\n  const adicionarItem = () => {\r\n    setItens([...itens, { produto_id: '', quantidade: 1, preco_unitario: 0 }]);\r\n  };\r\n\r\n  const removerItem = (index) => {\r\n    const novosItens = itens.filter((_, i) => i !== index);\r\n    setItens(novosItens);\r\n  };\r\n\r\n  const finalizarVenda = async () => {\r\n    const token = localStorage.getItem('token');\r\n    try {\r\n      const payload = {\r\n        cliente_id: clienteId || null,\r\n        itens\r\n      };\r\n      const res = await api.post('/vendas', payload, {\r\n        headers: { Authorization: `Bearer ${token}` }\r\n      });\r\n      alert(`✅ Venda registrada! ID: ${res.data.venda_id}`);\r\n      setClienteId('');\r\n      setItens([{ produto_id: '', quantidade: 1, preco_unitario: 0 }]);\r\n    } catch (err) {\r\n      console.error(err);\r\n      alert('❌ Erro ao registrar venda');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"venda-container\">\r\n      <h2>🛒 Registrar Venda</h2>\r\n\r\n      <select value={clienteId} onChange={e => setClienteId(e.target.value)}>\r\n        <option value=\"\">Cliente (opcional)</option>\r\n        {clientes.map(c => (\r\n          <option key={c.id} value={c.id}>{c.nome}</option>\r\n        ))}\r\n      </select>\r\n\r\n      {itens.map((item, index) => (\r\n        <div key={index} className=\"item-venda\">\r\n          <select\r\n            value={item.produto_id}\r\n            onChange={e => handleItemChange(index, 'produto_id', e.target.value)}\r\n          >\r\n            <option value=\"\">Produto</option>\r\n            {produtos.map(p => (\r\n              <option key={p.id} value={p.id}>{p.nome}</option>\r\n            ))}\r\n          </select>\r\n\r\n          <input\r\n            type=\"number\"\r\n            placeholder=\"Qtd\"\r\n            value={item.quantidade}\r\n            onChange={e => handleItemChange(index, 'quantidade', e.target.value)}\r\n            min={1}\r\n          />\r\n\r\n          <input\r\n            type=\"number\"\r\n            placeholder=\"Preço unitário\"\r\n            value={item.preco_unitario}\r\n            onChange={e => handleItemChange(index, 'preco_unitario', e.target.value)}\r\n            min={0}\r\n            step=\"0.01\"\r\n          />\r\n\r\n          <button onClick={() => removerItem(index)}>🗑️</button>\r\n        </div>\r\n      ))}\r\n\r\n      <button onClick={adicionarItem}>➕ Adicionar Produto</button>\r\n\r\n      <h3>Total: R$ {valorTotal.toFixed(2)}</h3>\r\n\r\n      <button className=\"finalizar-btn\" onClick={finalizarVenda}>💾 Finalizar Venda</button>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Venda;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}